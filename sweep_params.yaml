method: random
project: mha-based-fsgnn
metric:
  name: test/test_accuracy
  goal: maximize

# Parameter space to search
parameters:
  #nested parameter configuration
  dataset:
    parameters:
      dataset_name:
        value: "Cora"
      max_hop:
        values: [2,3,4,5,6,7,8]

  mlp:
    parameters:
      hidden_dims:
        max: 600
        min: 100
      out_dim:
        value: 64
      dropout:
        max: 0.9
        min: 0.5

  mha:
    parameters:
      fan_out:
        values: [64,128,256]
      p:
        max: 0.9
        min: 0.5

  optimizer:
    parameters:
      # lr parameter is nested behind "optimizer"
      lr:
        max: 0.01
        min: 0.0001
      weight_decay:
        max: 0.01
        mix: 0.0001

  trainer_pipeline:
    parameters:
      max_epochs:
        value: 500
      patience:
        value: 70

  skip_connection:
    value: False

#! n_heads will be declared from max_hop in sweep.py
#! if skip connection is enabled, fan_out of mha must be equal to out_dim of mlp
#! fan_in of mha must be equal to out_dim of mlp
  